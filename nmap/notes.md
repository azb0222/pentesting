# NMAP 
- **nmap**: network scanning and enumeration tool, identifies active hosts, host info, security measures (ie. firewalls, packet filters, etc.) using packets 
    - `nmap <scan types> <options> <target>`
        - scan types: 
            - TCP-SYN scan (`-sS`): scan several thousand ports per second; only sends one packet w/ SYN flag to not complete three-way TCP handshake (SYN, SYN-ACK, SYN); therefore does NOT create a complete TCP connection
                - target sends SYN-ACK flagged packet: open port
                - target sends RST (reset) flagged packet: closed port 
                - target sends no packet: packet dropped by firewall; nmap displays as filtered
    - best practice to store all scan results

## Host Discovery
- **scan network range**:
    - `nmap 10.129.2.0/24 -sn -oA tnet | grep for | cut -d"
        - `-sn`: ping scan instead of full port scan/disable port scan 
        - `-oA tnet`: output results into three file formats starting with name `tnet`(tnet.namp, tnet.xml, tnet.gnmap)
        - pipe and format display to only show IPs of available hosts 
    - will only work if host firewall allows for ICMP requests
- **scan IP list**:
    - say hosts.lst contains list of IPs
    - `nmap -sn -oA tnet -iL hosts.lst | grep for | cut -d" " -f5`
- **scan multiple IPs**: `nmap -sn -oA tnet 10.129.2.18 101.129.2.19`
- **scan single IP**: `nmap 10.129.2.18 -sn -oA host` 
     - `-oA host`: output results into three file formats starting with name `host`

### Protocols 
- **ARP (Address Resolution Protocol)**: Layer 2 (Data Link Layer) protocol to map IP address -> MAC address on a LAN 
    - **ARP Request**: requests corresponding MAC address for an IP/ "which machine has xyz IP?"
    - no authentication mechanisms 
        - ex. device A wants to send packet to device B w/ IP 192.168.3.2; device A sends ARP request packet to all devices on LAN; device B responds with ARP reply packet w/ its MAC address
        - vulnerable to **ARP Spoofing**: attacker sends false ARP messages 
    - **ARP Scan**: discover active hosts by sending ARP requests to each IP address in target range
        - if host is active, will send ARP response 
        - typically no firewall interference, as firewalls typically operate at Layer 3 and above 
        - limited to LAN, cannot use across routers

- **ICMP**: ping 
    - use ICMP echo request/reply packets 
    - can be blocked by firewalls 
    - can be used on LAN and remote networks



## Port Scanning 


## Service Enumeration/ Detection 


## OS Detection 


## Nmap Scripting Engine 